
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>ELE 503 Homework 7</title><meta name="generator" content="MATLAB 9.2"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2018-11-28"><meta name="DC.source" content="hw7.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>ELE 503 Homework 7</h1><!--introduction--><p>Noah Johnson</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Problem 1a</a></li><li><a href="#2">Problem 1b.1 (Bessel Poles Regulator)</a></li><li><a href="#3">Problem 1b.2 (Selected Poles Regulator)</a></li><li><a href="#4">Problem 1c (Analysis)</a></li><li><a href="#5">Problem 2a (6.10a)</a></li><li><a href="#6">Problem 2b.1 (Bessel Pole Regulator)</a></li><li><a href="#7">Problem 2b.2 (SDPP/ADP Regulator)</a></li><li><a href="#8">Problem 2c (Graphing)</a></li><li><a href="#9">Problem 2d (Analysis)</a></li><li><a href="#10">Problem 3.1 (Tabulated Bessel Poles)</a></li><li><a href="#11">Problem 3.2 (Selected Poles)</a></li><li><a href="#12">Problem 4a/b (MIM0 System Regulation)</a></li><li><a href="#13">Problem 4c (Analysis)</a></li></ul></div><h2 id="1">Problem 1a</h2><pre class="codeinput">A = [-30 0 0 0; 0 0 1 0; 1225 -1225 -21 0; 0 1 0 0];
B = [30; 0; 0; 0];
C = [0 0 0 1];
D = zeros;

Ts = 0.35; <span class="comment">%define settling time of system</span>

load <span class="string">sroots</span>; <span class="comment">%load tabulated bessel poles</span>

plantPoles = eig(A);
adp = s1/Ts +  imag(plantPoles(2))*i;
sPoles1 = s4/Ts; <span class="comment">%Normalized Bessel Poles only</span>
sPoles2 = [plantPoles(4) adp conj(adp) s1/Ts]; <span class="comment">% SDPP,ADP,NBP</span>

K1 = place(A,B,sPoles1);
K2 = place(A,B,sPoles2);

<span class="comment">% Classical Stability Margins, Robustness Bounds</span>

<span class="comment">%Normalized Bessel Poles only</span>
fprintf(<span class="string">'------------------- Bessel Poles -------------------\n\n'</span>);
asm(A,B,K1)
[del1_1,del2_1] = rb_regsf(A,B,K1,0)

<span class="comment">% SDPP,ADP,SBP</span>
fprintf(<span class="string">'------------------- SDPP/ADP Poles -------------------\n\n'</span>);
asm(A,B,K2)
[del1_2, del2_2] = rb_regsf(A,B,K2,0)
</pre><pre class="codeoutput">------------------- Bessel Poles -------------------

Upper gain margin for input #1 is 3.29 dB

Lower gain margin for input #1 is -30.1 dB

Phase margin for input #1 is 49 degrees


del1_1 =

    0.4565


del2_1 =

    0.3147

------------------- SDPP/ADP Poles -------------------

Upper gain margin for input #1 is 30.1 dB

Lower gain margin for input #1 is -30.1 dB

Phase margin for input #1 is 98 degrees


del1_2 =

    1.0000


del2_2 =

     1

</pre><h2 id="2">Problem 1b.1 (Bessel Poles Regulator)</h2><pre class="codeinput">x0 = [0;0;0;-1];
K = K1;
results = sim(<span class="string">"reg_asf.slx"</span>,<span class="string">'StopTime'</span>, <span class="string">'0.525'</span>);
tout = results.tout;
u = results.u;
x = results.x;
<span class="comment">%run reg_asfp script, open result</span>
open(<span class="string">'BesselPoles.fig'</span>)
</pre><img vspace="5" hspace="5" src="hw7_01.png" alt=""> <h2 id="3">Problem 1b.2 (Selected Poles Regulator)</h2><pre class="codeinput">x0 = [0;0;0;-1];
K = K2;<span class="comment">%  The first set of bessel poles gave decent classical stablity bounds,</span>
results = sim(<span class="string">"reg_asf.slx"</span>,<span class="string">'StopTime'</span>, <span class="string">'0.525'</span>);
tout = results.tout;
u = results.u;
x = results.x;
<span class="comment">%run reg_asfp script, open result</span>
open(<span class="string">'SelectedPoles.fig'</span>)
</pre><img vspace="5" hspace="5" src="hw7_02.png" alt=""> <h2 id="4">Problem 1c (Analysis)</h2><pre>The first set of bessel poles gave decent classical stablity bounds,
however the delta values are unacceptable. There is also a very slight
overshoot in the position, as seen on the graph of x4.</pre><pre>The second set of poles gave extremely good delta bounds, however the
graphs look abnormal to me. After checking my work I can find no error.
The only concern with the second regulator design is that the plant
input sharply spikes to 15 volts (assuming the units are indeed volts),
which would saturate the cart pendulum system and likely cause issues.</pre><h2 id="5">Problem 2a (6.10a)</h2><pre>Note that the following constants result in a system that decays in ~
17.5 seconds</pre><pre class="codeinput">A = [0 1 0; -4 -.4 40; 0 0 -4];
B = [0;0;2];
x0 = [0.34;0;0];
K = zeros(1,3);
open_system(<span class="string">'reg_asf/u'</span>)
open_system(<span class="string">'reg_asf/x'</span>)
results = sim(<span class="string">"reg_asf.slx"</span>,<span class="string">'StopTime'</span>, <span class="string">'20'</span>);
results = sim(<span class="string">"reg_asf.slx"</span>,<span class="string">'StopTime'</span>, <span class="string">'20'</span>);

tout = results.tout;
u = results.u;
x = results.x;

snapnow
close_system(<span class="string">'reg_asf'</span>);
</pre><img vspace="5" hspace="5" src="hw7_03.png" alt=""> <img vspace="5" hspace="5" src="hw7_04.png" alt=""> <h2 id="6">Problem 2b.1 (Bessel Pole Regulator)</h2><pre class="codeinput">plantPoles = eig(A)
Ts = 4.5;
spoles1 = s3/Ts;
K1 = place(A,B,spoles1);
K = K1;
fprintf(<span class="string">'------------------- Bessel Poles -------------------\n\n'</span>);
asm(A,B,K1)
[del1_1,del2_1] = rb_regsf(A,B,K1,0)

results = sim(<span class="string">"reg_asf.slx"</span>,<span class="string">'StopTime'</span>, <span class="string">'6.75'</span>);
tout = results.tout;
u = results.u;
x = results.x;
</pre><pre class="codeoutput">
plantPoles =

  -0.2000 + 1.9900i
  -0.2000 - 1.9900i
  -4.0000 + 0.0000i

------------------- Bessel Poles -------------------

Upper gain margin for input #1 is 0.95 dB

Lower gain margin for input #1 is -30.1 dB

Phase margin for input #1 is 11 degrees


del1_1 =

    0.1152


del2_1 =

    0.1033

</pre><h2 id="7">Problem 2b.2 (SDPP/ADP Regulator)</h2><pre>Here we choose 1 SDPP and 2 ADP type regulator poles</pre><pre class="codeinput">adp = s1/Ts + imag(plantPoles(1))*1i;
spoles2 = [plantPoles(3) adp conj(adp)];
K2 = place(A,B,spoles2);
K = K2;
fprintf(<span class="string">'------------------- SDPP/ADP Poles -------------------\n\n'</span>);
asm(A,B,K2)
[del1_2, del2_2] = rb_regsf(A,B,K2,0)

results = sim(<span class="string">"reg_asf.slx"</span>,<span class="string">'StopTime'</span>, <span class="string">'6.75'</span>);
tout = results.tout;
u = results.u;
x = results.x;
</pre><pre class="codeoutput">------------------- SDPP/ADP Poles -------------------

Upper gain margin for input #1 is 30.1 dB

Lower gain margin for input #1 is -30.1 dB

Phase margin for input #1 is 93 degrees


del1_2 =

    1.1978


del2_2 =

     1

</pre><h2 id="8">Problem 2c (Graphing)</h2><pre>The Scaled Bessel Poles yield a system which decays to zero in
approximately 5.5 seconds (1% Settling time)</pre><pre>The Selected Poles yield a system which decays to zero in
approximately 3.85 seconds (1% Settling time)</pre><pre class="codeinput">open(<span class="string">'BesselPoles2.fig'</span>)
open(<span class="string">'SelectedPoles2.fig'</span>)
</pre><img vspace="5" hspace="5" src="hw7_05.png" alt=""> <img vspace="5" hspace="5" src="hw7_06.png" alt=""> <h2 id="9">Problem 2d (Analysis)</h2><pre>The second set of poles yields far better results than the first set of
tabulated poles. In fact, the robustness of the first system is
completely unacceptable, see 2b.1, while the second system is very
stable.</pre><h2 id="10">Problem 3.1 (Tabulated Bessel Poles)</h2><pre>This system seems stable when we only look at the classical bounds.
However when we look at the robustness bounds, the system is unusable.</pre><pre class="codeinput">A = [0 1 0 0; 23.1 0 0 -0.1189; 0 0 0 1; 0 0 0 -25];
B = [0; 12.5; 0; 26.33];
x0 = [0; 0.17; 0; 0];


Ts = 0.95;

plantPoles = eig(A);

sPoles1 = s4/Ts;

K1 = place(A,B,sPoles1);

K = K1;

load_system(<span class="string">'reg_asf'</span>)
results = sim(<span class="string">"reg_asf.slx"</span>,<span class="string">'StopTime'</span>, <span class="string">'1.425'</span>);
tout = results.tout;
u = results.u;
x = results.x;

<span class="comment">%Normalized Bessel Poles only</span>
fprintf(<span class="string">'------------------- Bessel Poles -------------------\n\n'</span>);
asm(A,B,K1)
[del1_1,del2_1] = rb_regsf(A,B,K1,0)

open(<span class="string">'BesselPoles3x1.fig'</span>);
open(<span class="string">'BesselPoles3x2.fig'</span>);
</pre><pre class="codeoutput">------------------- Bessel Poles -------------------

Upper gain margin for input #1 is 11.53 dB

Lower gain margin for input #1 is -4.64 dB

Phase margin for input #1 is 22 degrees


del1_1 =

    0.3240


del2_1 =

    0.3693

</pre><img vspace="5" hspace="5" src="hw7_07.png" alt=""> <img vspace="5" hspace="5" src="hw7_08.png" alt=""> <h2 id="11">Problem 3.2 (Selected Poles)</h2><pre>This system is only slightly better when only the classical margins are
considered, but it is the only acceptable one when we consider
robustness bounds. The settling time is comparable.</pre><pre class="codeinput">sPoles2 = [plantPoles(4) s3/Ts];

K2 = place(A,B,sPoles2);

K = K2;

load_system(<span class="string">'reg_asf'</span>)
results = sim(<span class="string">"reg_asf.slx"</span>,<span class="string">'StopTime'</span>, <span class="string">'1.425'</span>);
tout = results.tout;
u = results.u;
x = results.x;

<span class="comment">% SDPP,ADP,SBP</span>
fprintf(<span class="string">'------------------- SDPP/ADP Poles -------------------\n\n'</span>);
asm(A,B,K2)
[del1_2, del2_2] = rb_regsf(A,B,K2,0)

open(<span class="string">'SelectedPoles3x1.fig'</span>);
open(<span class="string">'SelectedPoles3x2.fig'</span>);
</pre><pre class="codeoutput">------------------- SDPP/ADP Poles -------------------

Upper gain margin for input #1 is 30.1 dB

Lower gain margin for input #1 is -8.91 dB

Phase margin for input #1 is 59 degrees


del1_2 =

    0.5834


del2_2 =

    0.9761

</pre><img vspace="5" hspace="5" src="hw7_09.png" alt=""> <img vspace="5" hspace="5" src="hw7_10.png" alt=""> <h2 id="12">Problem 4a/b (MIM0 System Regulation)</h2><pre class="codeinput">A = [1.38 -0.2077 6.715 -5.676; -0.5814 -4.29 0 0.675; 1.067 4.273 -6.654 5.893; 0.048 4.273 1.343 -2.104];
B = [0 0; 5.679 0; 1.136 -3.146; 1.136 0];

Ts = 20;

sPoles = [-8.6635 -5.0572 -1.991 s1/Ts];

K1 = place(A,B,sPoles);

fprintf(<span class="string">'------------------- Results using place() -------------------\n\n'</span>);
[del1_1, del2_1] = rb_regsf(A,B,K1,0)

clp1 = eig(A-B*K1)

fprintf(<span class="string">'------------------- Results using rfbg() -------------------\n\n'</span>);
[K2, del1_2, del2_2] = rfbg(A,B,sPoles,0)

clp2 = eig(A-B*K2)
</pre><pre class="codeoutput">------------------- Results using place() -------------------


del1_1 =

    0.0673


del2_1 =

    0.0717


clp1 =

   -8.6635
   -5.0572
   -0.2310
   -1.9910

------------------- Results using rfbg() -------------------

delta values:
0.4131   0.6834
0.5141   0.9697
0.5155   0.9801
0.5144   1.0000

K2 =

    0.8563    0.2304    0.6265   -0.2464
   -1.1126   -0.2568   -0.8055    0.3543


del1_2 =

    0.5144


del2_2 =

    1.0000


clp2 =

   -0.2310
   -1.9910
   -5.0572
   -8.6635

</pre><h2 id="13">Problem 4c (Analysis)</h2><pre>It is clear to see that the results given by place are not usable. The
derived system is not robust, and should clearly not be tested in
hardware. The second system is far more robust, due to the iterative
nature of rfbg(). This system is ready for hardware testing.</pre><pre>It is noteworthy that the closed-loop poles for both systems are
identical, but this is not enough to say anything about the feasibility
of a hardware test.</pre><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2017a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% ELE 503 Homework 7
% Noah Johnson
%% Problem 1a

A = [-30 0 0 0; 0 0 1 0; 1225 -1225 -21 0; 0 1 0 0];
B = [30; 0; 0; 0];
C = [0 0 0 1];
D = zeros;

Ts = 0.35; %define settling time of system

load sroots; %load tabulated bessel poles

plantPoles = eig(A);
adp = s1/Ts +  imag(plantPoles(2))*i; 
sPoles1 = s4/Ts; %Normalized Bessel Poles only
sPoles2 = [plantPoles(4) adp conj(adp) s1/Ts]; % SDPP,ADP,NBP

K1 = place(A,B,sPoles1);
K2 = place(A,B,sPoles2);

% Classical Stability Margins, Robustness Bounds

%Normalized Bessel Poles only
fprintf('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH- Bessel Poles REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-\n\n');
asm(A,B,K1)
[del1_1,del2_1] = rb_regsf(A,B,K1,0)

% SDPP,ADP,SBP
fprintf('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH- SDPP/ADP Poles REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-\n\n');
asm(A,B,K2)
[del1_2, del2_2] = rb_regsf(A,B,K2,0)

%% Problem 1b.1 (Bessel Poles Regulator)
x0 = [0;0;0;-1];
K = K1;
results = sim("reg_asf.slx",'StopTime', '0.525');
tout = results.tout;
u = results.u;
x = results.x;
%run reg_asfp script, open result
open('BesselPoles.fig')

%% Problem 1b.2 (Selected Poles Regulator)
x0 = [0;0;0;-1];
K = K2;%  The first set of bessel poles gave decent classical stablity bounds,
results = sim("reg_asf.slx",'StopTime', '0.525');
tout = results.tout;
u = results.u;
x = results.x;
%run reg_asfp script, open result
open('SelectedPoles.fig')

%% Problem 1c (Analysis)
% 
%  The first set of bessel poles gave decent classical stablity bounds,
%  however the delta values are unacceptable. There is also a very slight
%  overshoot in the position, as seen on the graph of x4.
%
%
%  The second set of poles gave extremely good delta bounds, however the
%  graphs look abnormal to me. After checking my work I can find no error.
%  The only concern with the second regulator design is that the plant
%  input sharply spikes to 15 volts (assuming the units are indeed volts),
%  which would saturate the cart pendulum system and likely cause issues.
% 

%% Problem 2a (6.10a)
%  Note that the following constants result in a system that decays in ~
%  17.5 seconds
A = [0 1 0; -4 -.4 40; 0 0 -4];
B = [0;0;2];
x0 = [0.34;0;0];
K = zeros(1,3);
open_system('reg_asf/u')
open_system('reg_asf/x')
results = sim("reg_asf.slx",'StopTime', '20');
results = sim("reg_asf.slx",'StopTime', '20');

tout = results.tout;
u = results.u;
x = results.x;

snapnow
close_system('reg_asf');
%% Problem 2b.1 (Bessel Pole Regulator)

plantPoles = eig(A)
Ts = 4.5;
spoles1 = s3/Ts;
K1 = place(A,B,spoles1);
K = K1;
fprintf('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH- Bessel Poles REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-\n\n');
asm(A,B,K1)
[del1_1,del2_1] = rb_regsf(A,B,K1,0)

results = sim("reg_asf.slx",'StopTime', '6.75');
tout = results.tout;
u = results.u;
x = results.x;

%% Problem 2b.2 (SDPP/ADP Regulator)
%  Here we choose 1 SDPP and 2 ADP type regulator poles
adp = s1/Ts + imag(plantPoles(1))*1i;
spoles2 = [plantPoles(3) adp conj(adp)];
K2 = place(A,B,spoles2);
K = K2;
fprintf('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH- SDPP/ADP Poles REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-\n\n');
asm(A,B,K2)
[del1_2, del2_2] = rb_regsf(A,B,K2,0)

results = sim("reg_asf.slx",'StopTime', '6.75');
tout = results.tout;
u = results.u;
x = results.x;

%% Problem 2c (Graphing)
%
%  The Scaled Bessel Poles yield a system which decays to zero in
%  approximately 5.5 seconds (1% Settling time)
%
%  The Selected Poles yield a system which decays to zero in
%  approximately 3.85 seconds (1% Settling time)
%
open('BesselPoles2.fig')
open('SelectedPoles2.fig')

%% Problem 2d (Analysis)
%
%  The second set of poles yields far better results than the first set of
%  tabulated poles. In fact, the robustness of the first system is
%  completely unacceptable, see 2b.1, while the second system is very
%  stable.

%% Problem 3.1 (Tabulated Bessel Poles)
%  This system seems stable when we only look at the classical bounds.
%  However when we look at the robustness bounds, the system is unusable.

A = [0 1 0 0; 23.1 0 0 -0.1189; 0 0 0 1; 0 0 0 -25];
B = [0; 12.5; 0; 26.33];
x0 = [0; 0.17; 0; 0];


Ts = 0.95;

plantPoles = eig(A);

sPoles1 = s4/Ts;

K1 = place(A,B,sPoles1);

K = K1;

load_system('reg_asf')
results = sim("reg_asf.slx",'StopTime', '1.425');
tout = results.tout;
u = results.u;
x = results.x;

%Normalized Bessel Poles only
fprintf('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH- Bessel Poles REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-\n\n');
asm(A,B,K1)
[del1_1,del2_1] = rb_regsf(A,B,K1,0)

open('BesselPoles3x1.fig');
open('BesselPoles3x2.fig');

%% Problem 3.2 (Selected Poles)
%  This system is only slightly better when only the classical margins are
%  considered, but it is the only acceptable one when we consider
%  robustness bounds. The settling time is comparable.

sPoles2 = [plantPoles(4) s3/Ts];

K2 = place(A,B,sPoles2);

K = K2;

load_system('reg_asf')
results = sim("reg_asf.slx",'StopTime', '1.425');
tout = results.tout;
u = results.u;
x = results.x;

% SDPP,ADP,SBP
fprintf('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH- SDPP/ADP Poles REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-\n\n');
asm(A,B,K2)
[del1_2, del2_2] = rb_regsf(A,B,K2,0)

open('SelectedPoles3x1.fig');
open('SelectedPoles3x2.fig');

%% Problem 4a/b (MIM0 System Regulation)

A = [1.38 -0.2077 6.715 -5.676; -0.5814 -4.29 0 0.675; 1.067 4.273 -6.654 5.893; 0.048 4.273 1.343 -2.104];
B = [0 0; 5.679 0; 1.136 -3.146; 1.136 0];

Ts = 20;

sPoles = [-8.6635 -5.0572 -1.991 s1/Ts];

K1 = place(A,B,sPoles);

fprintf('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH- Results using place() REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-\n\n');
[del1_1, del2_1] = rb_regsf(A,B,K1,0)

clp1 = eig(A-B*K1)

fprintf('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH- Results using rfbg() REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-\n\n');
[K2, del1_2, del2_2] = rfbg(A,B,sPoles,0)

clp2 = eig(A-B*K2)

%% Problem 4c (Analysis)
% 
%  It is clear to see that the results given by place are not usable. The
%  derived system is not robust, and should clearly not be tested in
%  hardware. The second system is far more robust, due to the iterative
%  nature of rfbg(). This system is ready for hardware testing. 
%
%  It is noteworthy that the closed-loop poles for both systems are
%  identical, but this is not enough to say anything about the feasibility
%  of a hardware test.



##### SOURCE END #####
--></body></html>